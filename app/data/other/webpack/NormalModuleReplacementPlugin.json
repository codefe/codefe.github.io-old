{"sta":1,"data":{"subTitle":"NormalModuleReplacementPlugin","content":"<h3>安装</h3><p><code>NormalModuleReplacementPlugin</code><span>&nbsp;</span>是 webpack 一个内置插件。</p><h3>用法</h3><pre><code><span>new</span> <span>webpack<span>.</span>NormalModuleReplacementPlugin</span><span>(</span>resourceRegExp<span>,</span> newResource<span>)</span>\n</code></pre><p><code>NormalModuleReplacementPlugin</code>允许您将与<code>resourceRegExp</code>匹配的资源替换为<code>newResource</code>。如果<code>newResource</code>是相对的，它相对于先前的资源被解析。如果<code>newResource</code>是一个函数，则期望覆盖所提供的资源的请求属性。</p><p>这对于允许构建之间的不同行为是有用的。</p><h3>基础示例</h3><p>在构建开发环境时更换特定模块。</p><p>如果说你有一个配置文件<code>some/path/config.development.module.js</code>和一个特殊的版本生产在<code>some/path/config.production.module.js</code></p><p>只需在构建生产时添加以下插件：</p><pre><code><span>new</span> <span>webpack<span>.</span>NormalModuleReplacementPlugin</span><span>(</span>\n  <span>/some\\/path\\/config\\.development\\.js/</span><span>,</span>\n  <span>'./config.production.js'</span>\n<span>)</span><span>;</span>\n</code></pre><h3>高级示例</h3><p>条件构建取决于环境变量。</p><p>假设您想要一个具有不同构建目标的特定值的配置。</p><pre><code>module<span>.</span>exports <span>=</span> <span>function</span><span>(</span>env<span>)</span> <span>{</span>\n  <span>var</span> appTarget <span>=</span> env<span>.</span>APP_TARGET <span>||</span> <span>'VERSION_A'</span><span>;</span>\n  <span>return</span> <span>{</span>\n    plugins<span>:</span> <span>[</span>\n      <span>new</span> <span>webpack<span>.</span>NormalModuleReplacementPlugin</span><span>(</span><span>/(.*)-APP_TARGET(\\.*)/</span><span>,</span> <span>function</span><span>(</span>resource<span>)</span> <span>{</span>\n        resource<span>.</span>request <span>=</span> resource<span>.</span>request<span>.</span><span>replace</span><span>(</span><span>/-APP_TARGET/</span><span>,</span> <span><span>`-</span><span><span>${</span>appTarget<span>}</span></span><span>`</span></span><span>)</span><span>;</span>\n      <span>}</span><span>)</span>\n    <span>]</span>\n  <span>}</span>\n\n<span>}</span>\n</code></pre><p>创建两个配置文件：</p><p><strong>app/config-VERSION_A.js:</strong></p><pre><code><span>export</span> <span>default</span> <span>{</span>\n  title <span>:</span> <span>'I am version A'</span>\n<span>}</span>\n</code></pre><p><strong>app/config-VERSION_B.js:</strong></p><pre><code><span>export</span> <span>default</span> <span>{</span>\n  title <span>:</span> <span>'I am version B'</span>\n<span>}</span>\n</code></pre><p>然后使用您在regexp中查找的关键字导入该配置：</p><pre><code><span>import</span> config <span>from</span> <span>'app/config-APP_TARGET'</span><span>;</span>\nconsole<span>.</span><span>log</span><span>(</span>config<span>.</span>title<span>)</span><span>;</span>\n</code></pre><p>现在你只需要导入正确的配置，具体取决于你要构建的目标：</p><pre><code>webpack --env.APP_TARGET VERSION_A\n=&gt; 'I am version A'\n\nwebpack --env.APP_TARGET VERSION_B\n=&gt; 'I am version B'</code></pre>"}}